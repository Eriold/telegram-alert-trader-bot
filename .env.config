# -------------------------------------------------------------------
# Telegram bot config
# -------------------------------------------------------------------
# Bot token (from @BotFather). Required.
BOT_TOKEN=

# Chat IDs allowed to receive alerts and commands.
# Use a comma-separated list. Example: 123456789,-1001234567890
# If only one, you can still use CHAT_IDS=...
CHAT_IDS=

# Optional: legacy single chat id (only used if CHAT_IDS is empty).
# CHAT_ID=

# -------------------------------------------------------------------
# Alert behavior
# -------------------------------------------------------------------
# Enable/disable distance thresholds.
# 1 = enforce thresholds, 0 = ignore thresholds (send on 4 UP/DOWN only).
REQUIRE_DISTANCE_THRESHOLD=1

# Seconds before window end to fire alert (e.g. 65 ~ 1m05s).
ALERT_BEFORE_SECONDS=65

# Minimum seconds before window end (e.g. 10 => only alert between 65s and 10s).
ALERT_AFTER_SECONDS=10

# Polling interval for the alert loop (seconds).
POLL_SECONDS=5

# Audit logs for alert decisions (reasons for send/skip).
# 1 = enabled, 0 = disabled.
ALERT_AUDIT_LOGS=1

# Reject RTDS price if stale and fallback to API snapshot (seconds).
MAX_LIVE_PRICE_AGE_SECONDS=30

# -------------------------------------------------------------------
# Thresholds per market
# -------------------------------------------------------------------
# ETH 15m distance threshold (USD). Use 0 to disable threshold for this market.
ETH_15M_THRESHOLD=5
# ETH 1h distance threshold (USD). Use 0 to disable threshold for this market.
ETH_1H_THRESHOLD=20
# BTC 15m distance threshold (USD). Use 0 to disable threshold for this market.
BTC_15M_THRESHOLD=120
# BTC 1h distance threshold (USD). Use 0 to disable threshold for this market.
BTC_1H_THRESHOLD=300

# -------------------------------------------------------------------
# Command behavior (/eth15, /eth1h, /btc15, /btc1h)
# -------------------------------------------------------------------
# Polling interval for Telegram commands (seconds).
COMMAND_POLL_SECONDS=2

# How many previous closed markets to show in status (not counting live).
STATUS_HISTORY_COUNT=5

# Retries per missing status window when API data is incomplete/unavailable.
STATUS_API_WINDOW_RETRIES=3
# If status API is missing for closed windows, app applies external backup prices
# (Binance 1m candles) and marks those rows as "(estimado)".

# Manual preview commands (no spaces):
# /preview-eth15m, /preview-eth1h, /preview-btc15m, /preview-btc1h
# These commands send a preview message with inline "Confirmar operacion" button.
# In Fase 2, preview buttons are: Salir 70%, Salir 80%, Venc. 0.99.
# Help command: /help
# Manual preview format:
# /eth15m-B-sha-10-V-0.50
# /btc1h-S-sha-6-V-0.45-tp-70
# B=YES, S=NO, tp=70|80|99

# Maximum UPn/DOWNn value to report in alerts.
# Example: 8 => reports UP3..UP8 and DOWN3..DOWN8. If streak exceeds max, label shows "UP8+" / "DOWN8+".
MAX_PATTERN_STREAK=8

# -------------------------------------------------------------------
# Messages
# -------------------------------------------------------------------
# Startup message sent when the bot starts.
STARTUP_MESSAGE=Bot iniciado!

# Shutdown message sent when the bot stops gracefully.
SHUTDOWN_MESSAGE=Bot finalizado

# Telegram parse mode: HTML or MarkdownV2 (default HTML).
TELEGRAM_PARSE_MODE=HTML

# -------------------------------------------------------------------
# Operation preview (manual confirmation, no auto-execution)
# -------------------------------------------------------------------
# 1 = send operation preview with Telegram inline button, 0 = disable.
OPERATION_PREVIEW_ENABLED=1

# Trigger candle for operation preview (independent from alert trigger at UP3/DOWN3).
# Example: 6 => send preview when streak reaches UP6 or DOWN6.
OPERATION_PATTERN_TRIGGER=6

# Suggested number of shares displayed in preview template.
OPERATION_PREVIEW_SHARES=6

# Estimated market entry price per share for preview math.
# First source is next-window Gamma prices (Up/Down).
# If unavailable, this fallback value is used.
OPERATION_PREVIEW_ENTRY_PRICE=

# Target profit percentage used to estimate exit price and expected PnL in preview.
# Example: 70-80.
OPERATION_PREVIEW_TARGET_PROFIT_PCT=80

# -------------------------------------------------------------------
# Polymarket trading (CLOB)
# -------------------------------------------------------------------
# Trading mode:
# - preview: botones de Telegram solo confirman template (sin orden real)
# - live: al confirmar el boton envia orden market + orden limit real
TRADING_MODE=preview

# Master switch for live execution.
# 1 = permite ordenes reales cuando TRADING_MODE=live
# 0 = fuerza comportamiento preview
LIVE_TRADING_ENABLED=0

# Legacy compatibility switch (fallback if LIVE_TRADING_ENABLED no existe).
# Recomendado: mantener 0 y usar LIVE_TRADING_ENABLED.
POLYMARKET_ENABLE_TRADING=0

# Risk limits for each live trade.
MAX_SHARES_PER_TRADE=10
MAX_USD_PER_TRADE=25

# Seconds for checking limit close status.
ORDER_MONITOR_POLL_SECONDS=10

# Official CLOB host.
POLYMARKET_CLOB_HOST=https://clob.polymarket.com

# Polygon mainnet chain id.
POLYMARKET_CHAIN_ID=137

# Signature type:
# 0 = EOA wallet
# 1 = Magic/email wallet
# 2 = Browser wallet proxy (MetaMask typical in Polymarket UI)
POLYMARKET_SIGNATURE_TYPE=2

# Funder / proxy wallet address used by Polymarket account.
# For signature_type=2 this is usually required (check your Polymarket profile).
POLYMARKET_FUNDER_ADDRESS=

# Public address of the MetaMask account (EOA signer).
# Useful for validation/logging. Not a secret.
POLYMARKET_WALLET_ADDRESS=

# MetaMask wallet private key used by backend to sign CLOB requests (L1 auth).
# WARNING: never commit this. Keep only in local .env or secret manager.
POLYMARKET_WALLET_PRIVATE_KEY=
# Legacy alias (optional): POLYMARKET_PRIVATE_KEY=

# CLOB API credentials (L2 auth). If empty, app can derive them from L1 signature.
POLYMARKET_API_KEY=
POLYMARKET_API_SECRET=
POLYMARKET_API_PASSPHRASE=
POLYMARKET_API_KEY_NONCE=0

# If 1 and API creds above are empty, derive creds programmatically at startup.
POLYMARKET_DERIVE_API_CREDS=1

# Contracts (Polygon) used when setting allowances for trading.
POLYMARKET_USDC_CONTRACT=0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174
POLYMARKET_CTF_CONTRACT=0x4D97DCd97eC945f40cF65F87097ACe5EA0476045
POLYMARKET_EXCHANGE_CONTRACT=0x4bFb41d5B3570DeFd03C39a9A4d8de6bd8B8982E
POLYMARKET_NEG_RISK_EXCHANGE_CONTRACT=0xC5d563A36AE78145C45a50134d48A1215220f80a
POLYMARKET_NEG_RISK_ADAPTER_CONTRACT=0xd91E80cF2E7be2e162c6513ceD06f1dD0dA35296

# Optional proxy for all HTTP/WS traffic (e.g., HTTPS proxy via VPN).
PROXY_URL=https://127.0.0.1:40012

# Whether RTDS websocket should use proxy settings from PROXY_URL/HTTP(S)_PROXY.
# Set to 0 if websocket disconnects frequently with proxy enabled.
RTDS_USE_PROXY=1
